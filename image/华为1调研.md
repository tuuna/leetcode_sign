

## 概念与意义

### 文件索引结构

文件索引结构一般是指一个文件的信息存放在若干不连续的物理块中，系统为每个文件建立一个专用的数据结构，即索引表，将块号放到索引表中

### 对象索引结构

以ceph为例，维护一个key-value的map结构，map存放在object的omap(rocksdb)中，key对应rgw object，val是相关的一些元数据信息。

对象存储（Object Storage Service，OSS），也叫基于对象的存储，是一种解决和处理离散单元的方法，可提供基于分布式系统之上的对象形式的数据存储服务。对象存储和我们经常接触到的块和文件系统等存储形态不同，它提供RESTful API数据读写接口及丰富的SDK接口，并且常以网络服务的形式提供数据的访问。简单理解，对象存储类似酒店的代客泊车。顾客（前端应用）把车钥匙交给服务生，换来一张收据（对象的标识符）。顾客不用关心车（数据）具体停在哪个车位，这样省事儿、省时间。

**对象存储的优势**

早些年，传统数据中心主要是烟囱式架构，系统扩展性较差加上过去硬盘容量偏小、价格偏高，企业主要用存储保存关键数据，对象存储一直不温不火。在新数据时代，传统数据中心向云计算、大数据、人工智能转变，越来越多的应用和企业在使用新的存储形态，“对象存储”这个词变得炙手可热。

在云计算领域，公有云服务商都不约而同支持对象存储。百度云通过对象存储提供数据分发、备份、分析等服务并支持单文件最大5TB的文本、多媒体、二进制等任何类型的数据存储；阿里云使用对象存储的RESTful API接口，可以提供在互联网任何位置存储和访问数据；Amazon S3使用对象存储提供空间租赁服务等等。

可以说，对象存储作为新的存储类型，技术不断升级、应用规模日益扩大。Gartner预测，到 2021年，80%的企业数据将存储在包括对象存储在内的横向扩展存储系统中。对象存储 有什么了不起？作为新数据时代的新存储形态，相比SAN和NAS，对象存储有哪些优势？这可能是很多IT人关心的话题。要揭开这个谜题，可以从这几种存储形态的系统结构、数据管理、数据访问等维度进行探索。

当然，对象存储实现起来并非轻而易举，在技术特性、软件功能上需要不断打磨。作为国内领先的软件定义存储厂商，杉岩存储在存储新技术、新应用上不断加大投入，持续6年研发完善。这种在产品创新上的“死磕”，使得对象存在对象存储的技术创新方面别具优势。

杉岩对象存储MOS可提供对象存储服务，具备极致可靠、极致性能、极致安全、极易管理四大极致特性。在此基础上，还提供了诸多高级特性。这就好比一栋建筑，不光要地基打得牢、房子盖得结实，还要在装修上下功夫，符合入住者的个性化需求。

SandStone MOS是兼具企业级存储能力和智能检索处理能力的对象存储产品。新一代的存储引擎基于标准服务器构建一个可以线性扩展、几乎没有容量上限的跨地域存储架构，在提供高可靠和高可用服务能力的同时，集成了数据智能处理和分析能力，简化了海量数据处理所需的基础设施，以大幅提升数据处理的效率。

除了对象存储技术上的领先，杉岩数据在对象存储的“场景化”方面也走在了行业前列。在企业内容管理场景，杉岩数据支持柜台影像平台、档案系统、电子保单、物流电子快递单、ERP、邮件、CRM等业务系统管理，提供数据快速查询和调阅管理方案。越来越多的企业开始把存放在传统ECM系统中的文件、图片、影像等内容向对象存储系统迁移。

在金融影像存储场景，杉岩对象存储支持银行的票据影像、双录视频、人脸图像、纸质文件扫描件，保险公司的客服语音资料、电话营销语音资料，医院的医疗影像，这些文件数量巨大且需要长期保存。对象存储近乎无限的扩展性可以支持数据量不断增长的需求，存储设备与业务间挂接关系简单易维护，对象存储可以作为数据源直接进行大数据分析，挖掘影像数据中的价值信息。

IDC预测，未来5年，对象存储在中国SDS市场的增长率都将是最高的。可以说，进入新数据时代，云数智应用场景越来越丰富，数据规模像“滚雪球”一样在扩大，对象存储的优势将进一步放大，驶入发展快车道。

### 研究方向

目前课题主要研究**分布式存储架构**下，兼容文件与对象的索引结构（支持Range查询大规模索引）研究。

首先文件索引结构和对象索引结构在内存中其实是可以使用相似的结构比如HashMap来进行存储的，但是HashMap有几个明显的缺点。

- 无序：当进行查找操作，如果是范围查询，要列出所有的key需要至少O(k*n*log(n))的时间复杂，空间时间代价过高(不满足range scan的性能要求)
- 内存开销大

> 分布式存储架构下的索引结构相比单机环境需要满足什么样的特点？解决怎样的问题？这一点还不是很清晰

其次如果使用Tree类或者Trie，虽然可以弥补range scan的缺点，但是其内存开销仍然很大



### 开源产品

SlimTrie：对Trie进行了优化改造

SlimTrie的生成分为3部分：

-  先用一个Trie来构建所有key的索引。
-  在Trie的基础上进行裁剪, 将索引数据的量级从O(n * k)降低到O(n)。（Trie树访问磁盘的数目需要等于节点深度，通过分支压缩）
- 通过3个compacted array来存储整个Trie的数据结构, 将内存开销降低。

具体流程详见：https://blog.openacid.com/tech/algorithm/slimtrie-impl/

项目github: https://github.com/openacid/slim

使用厂家：baishancloud

